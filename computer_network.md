摘要：http的方法/http的header字段/实现即时通讯/DNS查询过程/cdn相关知识/状态码/http和https/加密/缓存/网络模型/UDP和TCP/get和post/跨域/http2/session和cookie

#### http的方法
- OPTIONS：查询服务器针对特定资源所支持的HTTP请求方法。
- HEAD：与GET请求相一致的响应，只是不返回响应体。用于确认URL的有效性及资源更新的日期时间等。
- GET：向服务器请求获取特定请求。
- POST：向特定资源提交数据进行处理请求，例如提交表单或者上传文件。数据包含在请求体中。
- PUT：向指定资源位置传输文件。
- DELETE：请求服务器删除特定资源。
- TRACE：客户端可以对请求消息的传输路径进行追踪。
- CONNECT：要求用隧道协议链接代理。

#### http的header字段
general
- Request URL
- Request Method
- Status Code
- Remote Address：服务器的IP地址

request header
- Referer：请求资源的页面的URL
- Accept：用户代理能够处理的媒体类型及媒体类型的相对优先级。
- Accept-Charset：用户代理支持的字符集及字符集的相对优先顺序。
- Accept-Encoding：用户代理支持的内容编码及内容编码的优先级顺序。
- Accept-Language：用户代理能够处理的自然语言集
- user-agent :用户代理名称
- Authorization：用户代理的认证信息
- Expires, cache-control, Etag, last-modified

response header
- Access-Control-Allow-Origin：标识允许哪个域的请求
- Access-Control-Allow-Credentials：是否允许跨域请求携带Cookie
- Date：创建请求的日期
- Content-Type：服务器接收的媒体类型
- Content-Encoding，Content-Language，Content-Length
- if-none-match, if-modified-since
- connection： keep-alive/closed

#### 怎么实现即时通讯，websocket的原理
1. 即时通讯：短轮询，长轮询，长连接，websocket。
2. WebSocket：通过单个TCP连接提供全双工（双向通信）通信信道的计算机通信协议。用户可以向服务器发送消息并接收事件驱动的响应。WebSocketAPI可以让多个用户连接到同一个实时服务器，并通过API进行通信并立即获得响应。工作原理是Pub-Sub（发布和订阅）。
3. websocket连接方式：
  1. 客户端发送GET 请求，Upgrade: websocket，Connection: Upgrade，告诉服务器，我要发起websocket协议。
  2. 服务器收到了协议，返回一个 Switching Protocol

#### DNS查询过程

  DNS作用是将用户请求的URL映射为具体的IP地址

1. 主机先向本地域名服务器进行递归查询。
2. 如果本地域名服务器不知道IP地址，则采用迭代查询，向根域名服务器进行递归查询。
3. 根域名服务器给出查询的IP，否则告诉本地域名服务器下一次查询的顶级域名服务器的IP地址。
4. 本地域名服务器向顶级域名服务器进行查询。
5. 顶级域名服务器给出查询的IP，否则告诉本地域名服务器下一次查询的权限域名服务器的IP地址。
6. 本地域名服务器向权限域名服务器进行查询。
7. 权限域名服务器告诉本地域名服务器所查询的主机的IP。
8. 本地域名服务器吧查询结果告诉主机。

#### cdn相关知识
CDN是内容分发网络。将源站内容分发至用户最近的节点，使用户可就近获取内容，提高用户访问的响应速度和成功率。解决因分布、带宽、服务器性能带来的访问延迟的问题，适用于站点加速、直播、点播等场景。

其基本思想是尽可能避开互联网上有可能影响数据传输速度和稳定性瓶颈的环节，使内容传输的更快、更稳定。通过在网络各处放置节点服务器所构成的在现有的互联网基础之上的一层智能虚拟网络，CDN系统能够实时地根据网络流量和各个节点的连接、负载情况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务器节点上。

#### 一个页面从输入 URL 到页面加载显示完成,这个过程中都发生了什么?
分为 4 个步骤:
1. 当发送一个 URL 请求时(可能是 Web 页面还是 Web 页面上每个资源的 URL),浏览器都会开启一个线程来处理这个请求,同时在远程 DNS 服务器上启动一个 DNS 查询,这能使浏览器获得请求对应的 IP 地址.
2. 浏览器与远程 Web 服务器通过 TCP 三次握手协商来建立一个 TCP/IP 连接.该握手包括一个同步报文,一个同步-应答报文和一个应答报文,这三个报文在 浏览器和服务器之间传递.该握手首先由客户端尝试建立起通信,而后服务器应答并接受客户端的请求,最后由客户端发出已经被接受的请求报文.
3. 一旦 TCP/IP 连接建立,浏览器会通过该连接向远程服务器发送 HTTP 的 GET 请求.远程服务器找到资源并使用 HTTP响应返回该资源,值为 200 的 HTTP 响应状态表示一个正确的响应.
4. 此时,Web 服务器提供资源服务,客户端开始下载资源.

#### 你了解的状态码

    200：请求成功
    201：已创建
    202：已接受
    204：请求成功，无返回内容
    301：永久重定向（搬家）
    302：临时重定向（去别人家玩）
    303：临时重定向，必须使用get方式请求。
    304：所请求的资源未修改，协商缓存生效
    400：请求错误/域名不存在
    401：未授权，协议格式出错
    403：禁止，服务器拒绝请求（forbidden）
    404：找不到系统资源（not found）
    500：服务器读取信息错误
    503：由于超载或系统维护，服务器暂时无法处理客户端的请求
    
#### 301和302前端怎么处理


#### http和https区别和关联
 - 关联：HTTP协议通常承载于TCP协议之上，当承载于TLS或SSL协议层之上就是HTTPS。
 - 区别：（层/端口/证书/连接方式/明文和加密）
     - HTTP属于应用层，HTTPS属于传输层
     - 默认HTTP的端口号为80，HTTPS的端口号为443
     - https协议需要到ca申请证书，一般免费证书较少，因而需要一定费用
     - http是超文本传输协议，信息是明文传输，https则是具有安全性的ssl加密传输协议
     - http的连接很简单，是无状态的；HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，比http协议安全

#### https连接过程和加密原理
客户端发送请求到服务器端，服务端返回证书，证书中有公钥。客户端先使用根证书验证证书合法性，然后生成对称密钥，用公钥给对称密钥加密后发送给服务端。服务器使用私钥解密，获取对称密钥。后续的数据通过对称秘钥进行加密解密。

#### 对称加密原理（des）
    对称密钥加密是指加密和解密使用同一个密钥的方式。
    优点效率高，缺点安全性。
    非对称加密是指使用一对非对称密钥，即公钥和私钥。公钥可以随意发布，但私钥只有自己知道。
    优点是安全性高，缺点是效率慢。（RSA）

#### 浏览器缓存
 - 强缓存：不发请求，直接从缓存读取资源。
 - 协商缓存：强制缓存失效后，浏览器携带缓存标识（If-Modified-Since和if-none-match）向服务器发起请求，由服务器根据缓存标识决定是否使用缓存的过程。

请求过程：有缓存时，Cache-Control/Expires不过期使用强缓存，否则进行协商缓存，服务器判断ETag与if-none-match&&Last-Modified与If-Modified-Since是否相同，相同则返回304，继续使用缓存；否则返回200和新的资源和缓存标识。
缓存的字段：
 - Cache-Control：控制网页缓存，可以组合使用多种指令：public，private，no-cache，no-store，max-age，s-maxage，max-stale
 - Expires：指定资源到期的时间，=max-age + 请求时间
 - Last-Modified，If-Modified-Since：资源在服务器上的最后修改时间
 - ETag：服务器响应请求时，返回当前资源文件的一个唯一标识(由服务器生成)，只要资源有变化，Etag就会重新生成。
 - if-none-match：= ETag

#### etag和last-modified区别

    本地打开缓存文件，即使没有修改，Last-Modified仍然被修改
    Last-Modified 只能以秒计时，在不可感知的时间内修改文件，服务端会认为资源还是命中了，返回304

#### 网络七层模型，每层的作用、具体协议有哪些
 - 七层模型：
   1.应用层：
     - 作用： 为运用程序提供服务并规定运用程序通信过程中相关细节
     - 常见的协议： FTP（文本传输协议） HTTP（超文本传输协议） TFTP（简单文本传输协议）DNS（域名解析服务协议） DHCP（动态主机配置协议）
   2.表示层：
     - 作用：负责数据格式的转换（包括加密），确保一方应用层数据能被另一方应用层理解
   3.会话层：
     - 作用： 管理主机之间的会话进程，即负责建立、管理、终止进程之间的会话
   4.传输层：
     - 作用： 为端到端连接提供传输服务
     - 协议： TCP/UDP
   5.网络层：
     - 作用： 将数据传输到目标地址，主要负责地址寻找和路由选择
     - 协议： IP/ICMP/
   6.数据链路层：
     - 作用： 物理地址寻址、数据的成帧、流量控制、数据的检错、重发
     - 协议： ARP/RARP/PPP 
   7.物理层：
     - 作用： 该层为上层协议提供了一个传输数据的物理媒体
 - http是应用层的，传输层用TCP或者UDP协议

#### tcp和udp的区别
（有无连接/可不可靠/单位/连接数量/首部开销/拥塞控制）
 1. tcp是面向连接的；udp是无连接的，发送数据之前不需要建立连接，减少了开销。
 2. tcp提供可靠交付的服务，传送的数据无差错、不丢失、不重复、并且按序到达。udp使用尽最大努力交付，即不保证可靠交付。
 3. tcp是面向字节流的。一次发送一个数据块，tcp把应用程序交下来的数据看成一连串的无结构的字节流。udp是面向报文的，对于报文即不合并，也不拆分，而是保留这些报文的边界，给多少就发多少，一次发送一个报文。
 4. tcp连接只能是点到点的。udp支持一对一，一对多，多对一和多对多的交互通信。
 5. tcp首部开销20字节。udp首部开销8个字节。
 6. tcp有拥塞控制。udp没有拥塞控制，网络拥塞不会使源主机的发送速率降低。很多实时应用（如ip电话、实时视频等）要求源主机以恒定速率发送数据，并且允许网路拥塞时丢失一些数据，但不允许数据有太大的时延，udp刚好适合。

#### TCP三次握手、四次挥手过程详解
 - 握手：
    1. 服务端处于listen（监听状态）
    2. 客户端向服务端发起主动连接请求，请求报文中不携带数据，首部中SYN=1，序列号seq=x，此时客户端处于syn—sent（同步发送）状态
    3. 服务端发送响应报文，报文中不携带数据，首部中SYN=1 ACK=1，ack=x+1，序列号=y，此时服务端处于syn—rcvd（同步收到）
    4. 客服端向服务端发送二次请求，请求报文可携带/不携带数据，首部中ACK=1，ack=y+1，seq=x+1（如果不发送数据，则不消耗序列号），此时客户端处于established(已建立连接)状态，服务端在接受到确认请求后也将进入established状态
 - 挥手：
    1. 客户端发出连接释放报文，报文中可携带/不携带数据，都需要消耗一个序列号 seq=u，FIN=1，此时客户端进入FIN-WAIT-1(终止等待1)状态此后不再发送数据
    2. 服务端发出确认报文，确认号是ack=u+1，seq=v，此时服务端进入wait-closed状态
    3. 此时客户端到服务端的连接已经释放，客服端处于fin-wait-2（终止等待2），tcp连接处于半关闭状态，客户端不能向服务端发送数据，但是服务端仍可向客户端发送数据
    4. 服务端发送连接释放报文，FIN=1，seq=w，ack=u+1，此时服务端进入last-ack状态
    5. 客户端收到报文后，再次发送确认报文，ACK=1，ack=w+1，seq=u+1.此时客户端进图time-wait状态，再经过2MSL后进入closed状态
    6. 服务端在接收到确认报文后进入clsoed状态
    
#### TCP握手，挥手，为什么握手三次，挥手四次
 - 握手：请求握手，确认，握手结束
     - 三次握手是为了防止已失效的请求连接报文忽然又传送到了，从而产生错误。
 - 挥手：请求挥手FIN，被动方确认ACK，被动方请求关闭连接FIN，确认ACK
     - ACK和FIN不可以合并，因为被动方可能还有数据没有传输完
     - 最后的ACK不可以省略，不然FIN如果丢失那就会主动方不会关闭连接
     - tcp连接是全双工工作模式，当客户端发送FIN请求后只能释放客户端到服务端的连接，客户端不能再发送数据，但此时服务端仍然可发送数据，只有服务端也FIN后，tcp连接才会被释放
     - 2msl（最长报文段寿命）：客户端在第二次发送ack后不会立马进入closed状态，还会经过一个time-wait的状态。这是为了保证服务端能正常收到客户端的ACK报文。如果服务端未收到ACK，那么会超时重传FIN报文，此时在2msl时间段内，客户端还未关闭连接，可重新发送ACK报文。如果没有2msl，那么服务端重发的FIN报文客户端不能收到，此时服务端不能正常释放连接

#### TCP如何保证可靠传输
 1. 数据包校验：目的是检测数据在传输过程中的任何变化，若校验出包有错，则丢弃报文段并且不给出响应，这时TCP发送数据端超时后会重发数据；
 2. 对失序数据包重排序：既然TCP报文段作为IP数据报来传输，而IP数据报的到达可能会失序，因此TCP报文段的到达也可能会失序。TCP将对失序数据进行重新排序，然后才交给应用层；
 3. 丢弃重复数据：对于重复数据，能够丢弃重复数据；
 4. 应答机制：当TCP收到发自TCP连接另一端的数据，它将发送一个确认。这个确认不是立即发送，通常将推迟几分之一秒；
 5. 超时重发：当TCP发出一个段后，它启动一个定时器，等待目的端确认收到这个报文段。如果不能及时收到一个确认，将重发这个报文段；
 6. 流量控制：TCP连接的每一方都有固定大小的缓冲空间。TCP的接收端只允许另一端发送接收端缓冲区所能接纳的数据，这可以防止较快主机致使较慢主机的缓冲区溢出，这就是流量控制。TCP使用的流量控制协议是可变大小的滑动窗口协议。

#### 拥塞窗口是什么？RTT是什么
 - 拥塞：在某段时间，若对网络中某一资源的需求超过了该资源所能提供的可用部分，网络的性能就会变坏，这种情况就叫做拥塞。
 - 拥塞控制：即防止过多的数据注入网络中，这样可以使网络中的路由器或链路不致过载。主要有以下四种方法：
     1. 慢启动：不要一开始就发送大量的数据，先探测一下网络的拥塞程度，即由小到大逐渐增加拥塞窗口的大小;
     2. 拥塞避免：拥塞避免算法让拥塞窗口缓慢增长，即每经过一个往返时间RTT就把发送方的拥塞窗口cwnd加1，而不是加倍，这样拥塞窗口按线性规律缓慢增长。
     3. 快重传：快重传要求接收方在收到一个失序的报文段后就立即发出重复确认（为的是使发送方及早知道有报文段没有到达对方），而不要等到自己发送数据时捎带确认。快重传算法规定，发送方只要一连收到三个重复确认就应当立即重传对方尚未收到的报文段，而不必继续等待设置的重传计时器时间到期。
     4. 快恢复：快重传配合使用的还有快恢复算法，当发送方连续收到三个重复确认时，就执行乘法减小算法，把ssthresh门限减半，但是接下去并不执行慢开始算法：因为如果网络出现拥塞的话就不会收到好几个重复的确认，所以发送方现在认为网络可能没有出现拥塞。所以此时将cwnd设置为ssthresh的大小，然后执行拥塞避免算法。
 - rtt：往返时间

#### GET和POST区别
- GET是从指定的资源请求数据，POST是向指定的资源提交要被处理的数据。
- GET的数据长度，不同的浏览器和服务器不同，一般限制在2~8K之间，更加常见的是1k以内。POST比较长。
- GET请求会被浏览器主动缓存，POST需要手动设置。
- GET的参数通过url传递,在浏览器地址栏可见,POST是在request body中传递。
- GET请求只能进行url编码，参数类型只接受ascii字符；POST请求支持多种编码方式，字符类型没有限制。
- GET产生一个TCP数据包，对于GET请求，浏览器会把header和data一并发送，服务器响应200；POST产生两个TCP数据包，对于POST请求，浏览器先发送header，服务器响应100 continue，浏览器再发送data，服务器响应200。但是并不所有浏览器都会在POST中发送两次包，火狐就只发送一次。

##### POST一般可以发送什么类型的文件
    表单提交数据：application/x-www-form-urlencoded
    表单上传文件：multipart/form-data
    json字符串：application/json
    xml文件：application/xml

#### 同源策略，跨域，跨域原理，跨域处理方法

    同源：协议,域名,端口相同
    同源策略是一种安全协议,指浏览器对不同源的脚本或文本的访问方式进行的限制。

#### 跨域，跨域原理，跨域处理方法
 - JSONP：
     - 原理是：动态插入script标签，通过script标签引入一个js文件，这个js文件载入成功后会执行我们在url参数中指定的函数，并且会把我们需要的json数据作为参数传入。
     - 优点是兼容性好，简单易用，支持浏览器与服务器双向通信。缺点是只支持GET请求。
 - CORS
     - 后台通过设置Access-Control-Allow-Origin来进行的
 - nginx反向代理：设置proxy_pass
 - node中间件代理
 - postmessage：HTML5

#### http2优点/HTTP1.1与HTTP 2.0的主要区别

    多路复用：一个连接并发处理多个请求
    二进制分帧：应用层和传输层之间增加二进制分帧层，底层数据格式发生改变，改进传输性能，实现低延迟和高吞吐量
    首部压缩：用HPACK算法对header进行压缩
    服务器推送：在客户端请求之前发送数据的机制

#### 网络层协议 IP/ARP/ICMP
  - ip协议实现主机与主机之间的通信，无连接不可靠，ip报文分片，通过路由器转发
  - ARP实现ip地址到硬地址（数据链路层、物理层)间的映射，作用与同一局域网。如果通信的主机不在同一局域网，那么先通过路由转发到，此时arp解析的是路由器的ip地址，然后再到达目的网路后，再用arp解析出主机的硬地址

#### session和cookie
1. cookie数据存放在客户的浏览器上，session数据放在服务器上。
2. cookie不是很安全，别人可以分析存放在本地的COOKIE并进行COOKIE欺骗，考虑到安全应当使用session。
3. session会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能，考虑到减轻服务器性能方面，应当使用COOKIE。
4. 单个cookie保存的数据不能超过4K，很多浏览器都限制一个站点最多保存20个cookie。


